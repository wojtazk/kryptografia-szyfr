<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Szyfr DUPA</title>
  </head>
  <body>
    <div id="content">
      <label for="input">Tekst ÅºrÃ³dÅ‚owy</label>
      <br />
      <textarea id="input" name="input" rows="10" cols="50"></textarea>
      <br />
      <input type="button" value="Zaszyfruj" id="btn-encrypt" />
      <input type="button" value="Odszyfruj" id="btn-decrypt" />
      <br />
      <br />

      <input type="button" value="ZamieÅ„ pola ðŸ”ƒ" id="btn-swap" />
      <br />
      <input
        type="button"
        value="WyczyÅ›Ä‡ tekst ÅºrÃ³dÅ‚owy â¬†ï¸"
        id="btn-clear-input"
      />
      <br />
      <input
        type="button"
        value="WyczyÅ›Ä‡ tekst wynikowy â¬‡ï¸"
        id="btn-clear-output"
      />

      <br />
      <br />

      <label for="output">Zaszyfrowany / odszyfrowany tekst</label>
      <br />
      <textarea id="output" name="output" rows="10" cols="50"></textarea>
    </div>

    <!-- jakies stylowanko -->
    <style>
      #content {
        width: fit-content;
        margin: auto;
      }
    </style>

    <!--  szyfrowanie tekstu  -->
    <script>
      'use strict';

      ////////////////////////////
      // alphabet and dictionaries
      const alphabet = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ ';

      const dictionaries = [
        alphabet,

        // Armenian
        'Ô±Õ¡Ô²Õ¢Ô³Õ£Ô´Õ¤ÔµÕ¥Ô¶Õ¦Ô·Õ§Ô¸Õ¨Ô¹Õ©ÔºÕªÔ»Õ«Ô¼Õ¬Ô½Õ­Ô¾Õ®Ô¿Õ¯Õ€Õ°ÕÕ±Õ‚Õ²ÕƒÕ³Õ„Õ´Õ…ÕµÕ†Õ¶Õ‡Õ·ÕˆÕ¸Õ‰Õ¹ÕŠÕºÕ‹Õ»ÕŒÕ¼ÕÕ½ÕŽÕ¾ÕÕ¿ÕÖ€Õ‘ÖÕ’Ö‚Õ“ÖƒÕ”Ö„Õ•Ö…Õ–Ö†',

        // Glagolitic
        'â±â°°â°±â±Œâ°´â°µâ±‡â°³â±’â°»â°¼â°½â°¾â°¿ â±€â±â±‚qâ±ƒâ±„â±…â±†â°²wâ±ˆâ°¹â°¸â°€â°â°œâ°„â°…â°—â°ƒâ°¢â°‹â°Œâ°â°Žâ°â°â°‘â°’Qâ°“â°”â°•â°–â°‚Wâ°˜â°‰',

        // Russian
        'ÐÐ°Ð‘Ð±Ð’Ð²Ð“Ð³Ð”Ð´Ð•ÐµÐÑ‘Ð–Ð¶Ð—Ð·Ð˜Ð¸Ð™Ð¹ÐšÐºÐ›Ð»ÐœÐ¼ÐÐ½ÐžÐ¾ÐŸÐ¿Ð¡ ÑÐ¢Ñ‚Ð£ÑƒÐ¤Ñ„Ð¥Ñ…Ð¦Ñ†Ð§Ñ‡Ð¨ÑˆÐ©Ñ‰',
      ];

      ////////////////////////////////////////
      // get input and output texarea elements
      const inputTextarea = document.getElementById('input');
      const outputTextarea = document.getElementById('output');

      /////////////////////////
      // button click listeners
      document.getElementById('btn-encrypt').addEventListener('click', () => {
        outputTextarea.value = szyfrowanko(inputTextarea.value);
      });

      document.getElementById('btn-decrypt').addEventListener('click', () => {
        outputTextarea.value = deszyfrowanko(inputTextarea.value);
      });

      document.getElementById('btn-swap').addEventListener('click', () => {
        const tmp = inputTextarea.value;
        inputTextarea.value = outputTextarea.value;
        outputTextarea.value = tmp;
      });

      document
        .getElementById('btn-clear-input')
        .addEventListener('click', () => {
          inputTextarea.value = '';
        });

      document
        .getElementById('btn-clear-output')
        .addEventListener('click', () => {
          outputTextarea.value = '';
        });

      ///////////////////////////////////////
      // encryption and decryption functions
      function szyfrowanko(
        plainText,
        startingDictionary = 0,
        startingShift = 1
      ) {
        let encryptedText = '';

        console.log('ENCRYPTINGðŸ”¥ðŸ”¥ðŸ”¥');

        let currentDictionaryIndex = startingDictionary;
        let currentShift = startingShift;
        for (let i = 0; i < plainText.length; i++) {
          // get index of current character
          const currentCharPosition = alphabet.indexOf(plainText[i]);

          // if there is no match just dont encrypt the character
          if (currentCharPosition === -1) {
            encryptedText += plainText[i];
            continue;
          }

          let shiftedCharPosition = currentCharPosition + currentShift;

          if (shiftedCharPosition >= alphabet.length) {
            shiftedCharPosition %= alphabet.length;
          }

          // add new character to encrypted text
          encryptedText +=
            dictionaries[currentDictionaryIndex][shiftedCharPosition];

          // increment current shift
          currentShift++;
          if (currentShift >= alphabet.length) {
            currentShift %= alphabet.length;
          }
          // move to the next dictionary
          currentDictionaryIndex++;
          if (currentDictionaryIndex >= dictionaries.length) {
            currentDictionaryIndex %= dictionaries.length;
          }
        }

        return encryptedText;
      }

      function deszyfrowanko(
        encryptedText,
        startingDictionary = 0,
        startingShift = 1
      ) {
        let decryptedText = '';

        console.log('DECRYPTINGðŸ’§ðŸ’§ðŸ’§');

        let currentDictionaryIndex = startingDictionary;
        let currentShift = startingShift;
        for (let i = 0; i < encryptedText.length; i++) {
          // get index of current character
          const currentCharPosition = dictionaries[
            currentDictionaryIndex
          ].indexOf(encryptedText[i]);

          // if there is no match just dont decrypt the character
          if (currentCharPosition === -1) {
            decryptedText += encryptedText[i];
            continue;
          }

          let shiftedCharPosition = currentCharPosition - currentShift;

          if (shiftedCharPosition < 0) {
            shiftedCharPosition += alphabet.length;
          }

          // add character to decrypted text
          decryptedText += alphabet[shiftedCharPosition];

          // increment current shift
          currentShift++;
          if (currentShift >= alphabet.length) {
            currentShift %= alphabet.length;
          }
          // move to the next dictionary
          currentDictionaryIndex++;
          if (currentDictionaryIndex >= dictionaries.length) {
            currentDictionaryIndex %= dictionaries.length;
          }
        }

        return decryptedText;
      }
    </script>
  </body>
</html>
